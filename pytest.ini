[tool:pytest]
# PlexAudioConverter pytest configuration
# Strong test system configuration per state_management_test_plan_step_2_and_beyond_v_1.md

# Test discovery
testpaths = tests state_management/tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Asyncio configuration
asyncio_mode = auto

# Output formatting
addopts = 
    --strict-markers
    --strict-config
    --tb=short
    --showlocals
    --durations=10
    --timeout=300
    --timeout-method=thread

# Markers for test categorization
markers =
    asyncio: Async test marker
    step2: Step 2 core functionality tests (T-001 to T-012)
    step4: Step 4 EN 2.0 policy tests (T-201+) - future implementation  
    step5: Step 5 group finalization tests (T-301+) - future implementation
    platform: Platform edge case tests (T-501 to T-504)
    windows: Windows-specific tests
    linux: Linux-specific tests
    unix: Unix/Linux-specific tests  
    reliability: Reliability, GC and migration tests (T-401 to T-403)
    performance: Performance and stress tests
    integration: End-to-end integration tests
    slow: Slow tests that take > 5 seconds
    xfail: Expected to fail (future features)
    skip: Skip these tests

# Timeout configuration
timeout = 300  # 5 minutes max per test
timeout_method = thread

# Warnings configuration
filterwarnings =
    error
    ignore::UserWarning
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

# Test collection
collect_ignore = 
    build/
    dist/
    .git/
    __pycache__/
    *.pyc

# Minimum Python version
minversion = 3.8

# Test output directory
junit_suite_name = PlexAudioConverter_StateManagement
junit_logging = all
junit_log_passing_tests = true
junit_family = xunit2

# Coverage integration (when pytest-cov is available)
# addopts includes coverage flags when run via run_tests.py